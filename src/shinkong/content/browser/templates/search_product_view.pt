<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    xmlns:v-on="http://vuejs.org"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="gct.content">
<body>
<metal:content-core fill-slot="content-core">
<metal:content-core define-macro="content-core"
                    tal:define="toc context/table_of_contents|nothing;">

Denier <input type="number" id="denier">

<div style="display: none" id='optionContainer'>
    Filament
    <select name="" id="filament" >
    </select>
<br>
    High Tenacity<input type='number' min='0' id='high_tenacity' step='0.1' >

    Elongation<input type='number' min='0' id='elongation' >

    H.A.S(2)<input type='number' min='0' id='has2' step='0.1' >
</div>

<button id='search_btn'>Search</button>

<br>

<div id="left_side" class='col-md-3'>
    <h3>應用產品</h3>
    <a tal:repeat="item view/application" href="${python: ite}">${item/Title}</a>
</div>

<div id='result' class='col-md-9'>
Result
</div>

<script>
$(function(){
    $('#denier').change(function () { 
        val = $(this).val()
        data = {
            'denier': val
        }
        url = location.href.replace('search_product_view', 'search_product_result')
        $.ajax({
            type: "post",
            url: url,
            data: data,
            success: function (rep) {
                data = JSON.parse(rep)
                debugger
                if(data.length != 0){
                    $('#optionContainer').show();
                    $('#filament').html("");
                    data.forEach(e => {
                        $('#filament').append("<option value=" + e + ">" + e + "</option>");
                    });
                }else{
                    $('#optionContainer').hide();
                    $('#result').html("查無資料");
                }
            }
        });
    });
    $('#search_btn').click(function(){
        denier = $("#denier").val();
        select_type = $('#select_type').val()
        high_tenacity = $('#high_tenacity').val()
        elongation = $('#elongation').val()
        has2 = $('#has2').val()
        filament = $("#filament").val()
        data = {
            'filament': filament,
            'select_type': select_type,
            'high_tenacity': high_tenacity,
            'elongation': elongation,
            'has2': has2,
            'denier': denier
        }
        url = location.href.replace('search_product_view', 'search_product_result')
        $.ajax({
            type: "post",
            url: url,
            data: data,
            success: function (rep) {
                $('#result').html(rep)
            }
        });    
    })
})
</script>

</metal:content-core>
</metal:content-core>

</body>
</html>

